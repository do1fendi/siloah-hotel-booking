(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{1493:function(e,t,l){Promise.resolve().then(l.bind(l,379))},379:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return w}});var a=l(9268),o=l(4522),n=l(6006),s=l(6008),c=l(1856),r=l(9944),i=l(7024),d=l(7480),h=l(5846),u=l.n(h),f=l(6341),p=l.n(f),g=l(2418);function m(e){let{showMap:t,closeMap:l,lat:o,lng:s}=e,[c,r]=(0,n.useState)({showMap:!1,lat:0,lng:0}),i=new g.aN({apiKey:"AIzaSyCviXyqFGkEvyasGss4RE9ML8Y7_hAfKk8",version:"weekly"});return i.load().then(async()=>{if(document.getElementById("map")){let{Map:e}=await window.google.maps.importLibrary("maps"),t=new e(document.getElementById("map"),{center:{lat:c.lat,lng:c.lng},zoom:15});new window.google.maps.Marker({position:{lat:c.lat,lng:c.lng},map:t,title:"Hello World!"})}}),(0,n.useEffect)(()=>{r({showMap:t,lat:o,lng:s})},[t]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p(),{src:"https://polyfill.io/v3/polyfill.min.js?features=default",strategy:"lazyOnload"}),t&&(0,a.jsx)("div",{className:"fixed top-0 left-0 right-0 w-full h-screen p-8 bg-gray-800/[.8]",children:(0,a.jsxs)("div",{className:"flex justify-end p-5 w-full h-full relative",children:[(0,a.jsx)("button",{onClick:l,className:"absolute top-2 right-2 bg-white z-30 shadow-xl rounded-full w-8 h-8 flex justify-center items-center pb-[3px]",children:(0,a.jsx)("span",{className:"text-2xl",children:"x"})}),(0,a.jsx)("div",{id:"map",className:"w-full h-full"})]})})]})}var x=l(1817);function y(e){let{data:t}=e,{currency:l}=(0,r.Z)(e=>e),{lang:o}=(0,c.Z)(e=>e),{dictionary:i}=(0,d.Z)(e=>e),h=(0,n.useRef)(null),f=(0,s.useSearchParams)(),[p,g]=(0,n.useState)({showMap:!1,lat:0,lng:0});(0,n.useEffect)(()=>{if(null!=t&&h.current)for(let e of h.current.children)e.classList.remove("scale-0"),e.classList.add("scale-100")},[t]);let y=(e,t)=>{g({showMap:!0,lat:e,lng:t})};return(0,a.jsxs)(a.Fragment,{children:[t&&null!==t&&t.GetHotelAvailRS&&t.GetHotelAvailRS.HotelAvailInfos&&(0,a.jsx)("div",{ref:h,className:"mt-8 flex flex-col gap-5 p-2 lg:p-0",children:t.GetHotelAvailRS.HotelAvailInfos.HotelAvailInfo.filter(e=>e.HotelRateInfo).map((e,t)=>(0,a.jsxs)("div",{className:"w-full border border-luxgreen hover:shadow-lg shadow-luxgreen p-2 lg:p-5 transform transition-all duration-700 ease-out scale-0",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"flex flex-col items-start",children:[(0,a.jsxs)("span",{className:"text-xl font-bold",children:[e.HotelInfo.HotelName," ",(0,a.jsx)("button",{onClick:()=>y(parseFloat(e.HotelInfo.LocationInfo.Latitude),parseFloat(e.HotelInfo.LocationInfo.Longitude)),children:(0,a.jsx)(x.GUT,{size:16,className:"text-orange-500 scale-10 hover:scale-125"})})]}),e.HotelInfo.PropertyQualityInfo&&e.HotelInfo.PropertyQualityInfo.PropertyQuality&&(0,a.jsx)("span",{className:"bg-teal-500 text-gray-100 rounded-lg text-xs lg:text-sm px-2 py-[2px]",children:"TW"===o?i.propertyQuality.filter(t=>t.code===e.HotelInfo.PropertyQualityInfo.PropertyQuality[0].Code)[0].tw:i.propertyQuality.filter(t=>t.code===e.HotelInfo.PropertyQualityInfo.PropertyQuality[0].Code)[0].en})]})}),(0,a.jsxs)("div",{className:"flex justify-between items-end",children:[(0,a.jsx)("p",{className:"text-sm capitalize",children:e.HotelRateInfo&&e.HotelRateInfo.Rooms?e.HotelRateInfo.Rooms.Room[0].RatePlans.RatePlan[0].RatePlanName.toString().toLowerCase():""}),(0,a.jsxs)("p",{className:"min-w-[80px]",children:["TWD"===l?"NT$ ":"$ ",(0,a.jsx)("span",{children:e.HotelRateInfo&&e.HotelRateInfo.RateInfos.ConvertedRateInfo.length>0?e.HotelRateInfo.RateInfos.ConvertedRateInfo[0].AmountAfterTax.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):e.HotelRateInfo&&e.HotelRateInfo.RateInfos.RateInfo&&e.HotelRateInfo.RateInfos.RateInfo[0].AmountAfterTax.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")})]})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(u(),{target:"_blank",href:{pathname:"/hotel",query:{searchCode:e.HotelInfo.HotelCode,room:parseInt(f.get("room")),adult:parseInt(f.get("adult")),children:parseInt(f.get("children")),childAges:f.get("childAges"),checkIn:f.get("checkIn"),checkOut:f.get("checkOut"),currency:l,lang:o}},children:(0,a.jsx)("button",{className:"bg-luxorange hover:bg-orange-500 text-gray-100 mt-5 text-md px-3 py-[2px] rounded",children:"TW"===o?"查看客房供應情況 >":"See avaibility >"})})})]},e.HotelInfo.HotelCode))}),(0,a.jsx)(m,{showMap:p.showMap,lat:p.lat,lng:p.lng,closeMap:()=>g({...p,showMap:!1})})]})}var I=l(5482);function w(){let[e,t]=(0,n.useState)(!1),{userData:l,setUserData:d}=(0,o.Z)(e=>e),[h,u]=(0,n.useState)(null),{currency:f}=(0,r.Z)(e=>e),{lang:p}=(0,c.Z)(e=>e),g=(0,s.useSearchParams)(),m=(0,s.useRouter)(),[x,w]=(0,n.useState)({city:"",room:0,adult:0,children:0,childAges:"",checkIn:"",checkOut:"",currency:"",lang:""});(0,n.useEffect)(()=>{null!=l&&(async()=>{let e={headers:{"Content-Type":"application/json","x-siloah":"siloah"},method:"POST",body:JSON.stringify({token:l.token})},t=await fetch("".concat("https://node.taiwanviptravel.com","/hotel/verifyToken"),e),a=await t.json();"Error"===a.status&&(d(null),window.location.reload())})()},[]),(0,n.useEffect)(()=>{w(e=>(e={...x,city:g.get("city"),room:parseInt(g.get("room")),adult:parseInt(g.get("adult")),children:parseInt(g.get("children")),childAges:g.get("childAges"),checkIn:g.get("checkIn"),checkOut:g.get("checkOut"),currency:f,lang:p},m.replace("/search/?city=".concat(e.city,"&checkIn=").concat(e.checkIn,"&checkOut=").concat(e.checkOut,"&room=").concat(e.room,"&adult=").concat(e.adult,"&children=").concat(e.children,"&childAges=").concat(e.childAges,"&lang=").concat(p,"&currency=").concat(f)),v(e),e))},[g,p,f]);let v=e=>{t(!0),(async()=>{let l={headers:{"Content-Type":"application/json","x-siloah":"siloah"},method:"POST",body:JSON.stringify(e)};try{let e=await fetch("".concat("https://node.taiwanviptravel.com","/hotel/hotelSearch/avail"),l),t=await e.json();console.log(t),u(t.data)}catch(e){console.log(e),alert("There is No Available Hotel")}t(!1)})()};return(0,a.jsxs)("div",{className:"container mx-auto max-w-[1024px]",children:[(0,a.jsx)("div",{className:"mt-5 shadow shadow-luxgreen p-5",children:(0,a.jsx)(i.Z,{})}),(0,a.jsx)(y,{data:h}),(0,a.jsx)(I.Z,{show:e})]})}}},function(e){e.O(0,[680,852,593,639,23,846,242,879,24,253,488,744],function(){return e(e.s=1493)}),_N_E=e.O()}]);